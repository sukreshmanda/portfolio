---
import { getCollection } from "astro:content";

const certificationEntries = await getCollection("certifications");

// Sort by start date, most recent first
const sortedcertifications = certificationEntries.sort(
  (a, b) => b.data.startDate.getTime() - a.data.startDate.getTime()
);

function formatPeriod(startDate: Date, endDate?: Date) {
  const options: Intl.DateTimeFormatOptions = {
    month: "short",
    day: "numeric",
    year: "numeric",
  };
  const start = startDate.toLocaleDateString("en-US", options);

  if (endDate && endDate.getTime() !== startDate.getTime()) {
    const end = endDate.toLocaleDateString("en-US", options);
    return `${start} - ${end}`;
  }

  return `${start} - present`;
}
---

<section id="certifications" class="py-20 px-4">
  <div class="max-w-4xl mx-auto">
    <div class="text-center mb-12">
      <h2 class="text-4xl font-bold mb-4">Cloud Certifications</h2>
      <p class="text-lg text-base-content/70">
        I'm committed to staying current with cloud technologies and best practices. These certifications demonstrate my expertise in designing, deploying, and managing cloud infrastructure across major platforms. Each certification represents hands-on knowledge and validation of my ability to build scalable, secure, and efficient cloud solutions.
      </p>
    </div>

    <div class="space-y-6">
      {
        sortedcertifications.map((certification) => (
          <div class="card bg-base-100 shadow-xl hover:shadow-2xl transition-shadow">
            <div class="card-body">
              <div class="flex items-start gap-4">
                {certification.data.logo && (
                  <div class="avatar flex-shrink-0">
                    <div class="w-16 h-16 rounded">
                      <img
                        src={certification.data.logo}
                        alt={certification.data.title}
                      />
                    </div>
                  </div>
                )}
                <div class="flex-1">
                  <time class="text-sm text-base-content/60">
                    {formatPeriod(
                      certification.data.startDate,
                      certification.data.endDate
                    )}
                  </time>
                  <h3 class="card-title mt-1">{certification.data.title}</h3>
                  <p class="text-base-content/80 mt-3">
                    {certification.data.description}
                  </p>
                  {certification.data.sourceLink && (
                    <div class="card-actions mt-4">
                      <a
                        href={certification.data.sourceLink}
                        target="_blank"
                        rel="noopener noreferrer"
                        class="btn btn-sm btn-outline btn-primary"
                      >
                        View Certification
                      </a>
                    </div>
                  )}
                </div>
              </div>
            </div>
          </div>
        ))
      }
    </div>
  </div>
</section>
